###user 包内逻辑

1. 一个用户去用户中心拿到一个UserToken
2. 用户带着UserToken发起websocket连接
3. user板块带着用户token 使用applo中的（secret）进行校验，每10s进行一次更新
4. 如果用户合法，建立链接


###user包职能(一)

1. 验证用户的token
2. 判断用户是否存在当前的token中
3. 每个websocket 预计最大承载10万人的链接数量
4. 加快查询速度和隔离用户提高并发，将所有用户hash到100个map（bucket）中


###user包职能（二）

1. 维护所有用户的连接
2. 监听用户的心跳
3. 识别单个用户所在的bucket
4. 快速判断当前token是否存在当前bucket集群中


###socket对外场景

1. 全盘推送
2. 单人推送
3. 群聊推送 (查找单人进行下发推送，性能较差)


###针对对外场景的优化手段

1. 全盘推送， 给所有用户进行广播，那么此时的广播就需要获取到所有用户的链接地址。
    ````
   存储： 使用map表，利用hash表的o1查找性能，快速获取到对应链接。
   基础： 一个大型map ，存放所有的token ：connection 
   缺点： 大型map的大型锁竞争激烈
   优化方式：将大锁打散变成小锁，构建多个bucket 存放用户，按照初始bucket 为8 按照
   ````